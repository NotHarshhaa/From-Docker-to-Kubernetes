---
title: Kubernetes Topology Aware Routing
description: Advanced guide to implementing zone-aware traffic management, latency-based optimization, and multi-region failover configurations for global service deployments
icon: 'lucide:network'
authors:
  - name: H A R S H H A A
    username: NotHarshhaa
    avatar: https://www.github.com/NotHarshhaa.png
    to: https://github.com/NotHarshhaa
    target: _blank
---

## Introduction to Kubernetes Topology Aware Routing

::alert{type="info"}
Kubernetes Topology Aware Routing provides sophisticated traffic management capabilities based on the physical or logical topology of your cluster infrastructure.
::

::div{class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4"}
  ::div{class="bg-blue-50 dark:bg-blue-900/20 rounded-xl p-5"}
    ::div{class="flex items-center"}
      ::div{class="text-blue-500 dark:text-blue-400"}
        <Icon name="lucide:arrow-big-right" class="h-5 w-5" />
      ::
      ::div{class="ml-2 font-semibold"}
        Zone-aware Traffic Distribution
      ::
    ::
    ::div{class="mt-2 text-sm"}
      Route service traffic to pods in the same zone as the client
    ::
  ::
  ::div{class="bg-blue-50 dark:bg-blue-900/20 rounded-xl p-5"}
    ::div{class="flex items-center"}
      ::div{class="text-blue-500 dark:text-blue-400"}
        <Icon name="lucide:zap" class="h-5 w-5" />
      ::
      ::div{class="ml-2 font-semibold"}
        Latency Optimization
      ::
    ::
    ::div{class="mt-2 text-sm"}
      Minimize network latency by preferring local endpoints
    ::
  ::
  ::div{class="bg-blue-50 dark:bg-blue-900/20 rounded-xl p-5"}
    ::div{class="flex items-center"}
      ::div{class="text-blue-500 dark:text-blue-400"}
        <Icon name="lucide:arrow-down-wide-narrow" class="h-5 w-5" />
      ::
      ::div{class="ml-2 font-semibold"}
        Cross-zone Traffic Reduction
      ::
    ::
    ::div{class="mt-2 text-sm"}
      Lower inter-zone data transfer costs and bandwidth usage
    ::
  ::
  ::div{class="bg-blue-50 dark:bg-blue-900/20 rounded-xl p-5"}
    ::div{class="flex items-center"}
      ::div{class="text-blue-500 dark:text-blue-400"}
        <Icon name="lucide:shield" class="h-5 w-5" />
      ::
      ::div{class="ml-2 font-semibold"}
        Failure Isolation
      ::
    ::
    ::div{class="mt-2 text-sm"}
      Improve resilience by containing failures within topology boundaries
    ::
  ::
::

This comprehensive guide explores the architecture, implementation patterns, and operational best practices for topology-aware routing in Kubernetes, helping you optimize application performance and reduce costs in distributed environments.

## Topology Aware Routing Architecture

### Core Concepts

::div{class="mb-4"}
  Kubernetes Topology Aware Routing builds on several foundational components:
::

::div{class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg overflow-x-auto my-4 border border-gray-200 dark:border-gray-700"}
```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                    Kubernetes Cluster                               │
│                                                                     │
│   ┌─────────────────┐         ┌─────────────────┐                   │
│   │                 │         │                 │                   │
│   │   Zone A        │         │   Zone B        │                   │
│   │                 │         │                 │                   │
│   │  ┌─────┐ ┌─────┐│         │  ┌─────┐ ┌─────┐│                   │
│   │  │Pod A│ │Pod B││         │  │Pod C│ │Pod D││                   │
│   │  └─────┘ └─────┘│         │  └─────┘ └─────┘│                   │
│   │                 │         │                 │                   │
│   └────────┬────────┘         └────────┬────────┘                   │
│            │                           │                            │
│   ┌────────▼───────────────────────────▼────────┐                   │
│   │                                             │                   │
│   │        Topology Aware Service               │                   │
│   │                                             │                   │
│   └─────────────────────┬───────────────────────┘                   │
│                         │                                           │
│                         │                                           │
│   ┌─────────────────────▼───────────────────────┐                   │
│   │                                             │                   │
│   │        EndpointSlice with Topology Hints    │                   │
│   │                                             │                   │
│   └─────────────────────────────────────────────┘                   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```
::

### Topology Key Concepts

::div{class="pl-4 border-l-4 border-blue-500 dark:border-blue-400 mb-6"}
  ::ul{class="space-y-2"}
    ::li{class="flex items-start"}
      ::div{class="text-blue-600 dark:text-blue-400 mr-2 mt-1"}
        <Icon name="lucide:tag" class="h-5 w-5" />
      ::
      ::div
        **Topology Keys**: Labels that identify infrastructure topology (zone, region, etc.)
      ::
    ::
    ::li{class="flex items-start"}
      ::div{class="text-blue-600 dark:text-blue-400 mr-2 mt-1"}
        <Icon name="lucide:layers" class="h-5 w-5" />
      ::
      ::div
        **EndpointSlice**: Enhanced endpoint grouping with topology information
      ::
    ::
    ::li{class="flex items-start"}
      ::div{class="text-blue-600 dark:text-blue-400 mr-2 mt-1"}
        <Icon name="lucide:settings" class="h-5 w-5" />
      ::
      ::div
        **Service Topology**: Service configuration that respects topology constraints
      ::
    ::
    ::li{class="flex items-start"}
      ::div{class="text-blue-600 dark:text-blue-400 mr-2 mt-1"}
        <Icon name="lucide:locate" class="h-5 w-5" />
      ::
      ::div
        **Topology Aware Hints**: Feature gate that enables preferential local routing
      ::
    ::
    ::li{class="flex items-start"}
      ::div{class="text-blue-600 dark:text-blue-400 mr-2 mt-1"}
        <Icon name="lucide:route" class="h-5 w-5" />
      ::
      ::div
        **Service Traffic Policy**: Controls how traffic is distributed across endpoints
      ::
    ::
  ::
::

## Enabling Topology Aware Routing

### Prerequisites

::callout{icon="lucide:list-checks" class="mb-6"}
#summary
Cluster Requirements
#content
Before implementing topology-aware routing, ensure your cluster meets these requirements:

::ul{class="space-y-1 mt-2"}
  ::li{class="flex items-start"}
    ::div{class="mr-2 mt-1 text-blue-600 dark:text-blue-400"}
      <Icon name="lucide:check" class="h-4 w-4" />
    ::
    Kubernetes 1.21 or newer (for Topology Aware Hints)
  ::
  ::li{class="flex items-start"}
    ::div{class="mr-2 mt-1 text-blue-600 dark:text-blue-400"}
      <Icon name="lucide:check" class="h-4 w-4" />
    ::
    Properly labeled nodes with topology information
  ::
  ::li{class="flex items-start"}
    ::div{class="mr-2 mt-1 text-blue-600 dark:text-blue-400"}
      <Icon name="lucide:check" class="h-4 w-4" />
    ::
    Compatible CNI plugin with topology support
  ::
  ::li{class="flex items-start"}
    ::div{class="mr-2 mt-1 text-blue-600 dark:text-blue-400"}
      <Icon name="lucide:check" class="h-4 w-4" />
    ::
    Appropriate service and deployment configurations
  ::
::
::

### Node Topology Labels

Verify your nodes have the required topology labels:

```bash
# Check node topology labels
kubectl get nodes --show-labels | grep topology.kubernetes.io

# Example output:
# worker-1   Ready    <none>   90d   v1.24.6   topology.kubernetes.io/zone=us-east-1a,topology.kubernetes.io/region=us-east-1
# worker-2   Ready    <none>   90d   v1.24.6   topology.kubernetes.io/zone=us-east-1b,topology.kubernetes.io/region=us-east-1
# worker-3   Ready    <none>   90d   v1.24.6   topology.kubernetes.io/zone=us-east-1c,topology.kubernetes.io/region=us-east-1
```

Add topology labels if they're missing:

```bash
# Add topology labels to nodes
kubectl label nodes worker-1 topology.kubernetes.io/zone=us-east-1a topology.kubernetes.io/region=us-east-1
kubectl label nodes worker-2 topology.kubernetes.io/zone=us-east-1b topology.kubernetes.io/region=us-east-1
kubectl label nodes worker-3 topology.kubernetes.io/zone=us-east-1c topology.kubernetes.io/region=us-east-1
```

### Feature Gate Configuration

Enable the Topology Aware Hints feature gate in your cluster:

For kube-apiserver, kube-controller-manager, and kube-scheduler, add:

```yaml
--feature-gates=TopologyAwareHints=true
```

For a kubeadm-managed cluster, modify the cluster configuration:

```yaml
apiVersion: kubeadm.k8s.io/v1beta3
kind: ClusterConfiguration
featureGates:
  TopologyAwareHints: true
```

## Implementing Zone-Aware Routing

### Basic Topology Aware Service

::div{class="mb-4"}
  Create a service with topology awareness enabled:
::

::code-group
```yaml [Zone-first Topology]
apiVersion: v1
kind: Service
metadata:
  name: topology-aware-service
spec:
  selector:
    app: myapp
  ports:
  - port: 80
    targetPort: 8080
  topologyKeys:
    - "topology.kubernetes.io/zone"
    - "topology.kubernetes.io/region"
    - "*"
```

This configuration will:
1. First attempt to route traffic to endpoints in the same zone
2. If no endpoints exist in the same zone, try endpoints in the same region
3. If no regional endpoints are available, fall back to any endpoint

### Using Topology Aware Hints

For newer Kubernetes versions, use the topology-aware hints approach:

```yaml
apiVersion: v1
kind: Service
metadata:
  name: topology-aware-service
  annotations:
    service.kubernetes.io/topology-aware-hints: "auto"
spec:
  selector:
    app: myapp
  ports:
  - port: 80
    targetPort: 8080
  type: ClusterIP
```

The "auto" setting enables Kubernetes to automatically distribute traffic based on endpoint topology.

### EndpointSlice Configuration

Inspect how EndpointSlices incorporate topology information:

```bash
kubectl get endpointslices -o yaml
```

Example EndpointSlice with topology hints:

```yaml
apiVersion: discovery.k8s.io/v1
kind: EndpointSlice
metadata:
  name: topology-aware-service-abc123
  labels:
    kubernetes.io/service-name: topology-aware-service
addressType: IPv4
ports:
  - name: http
    port: 8080
    protocol: TCP
endpoints:
  - addresses:
      - "10.0.1.1"
    conditions:
      ready: true
    hostname: pod-1
    nodeName: worker-1
    zone: "us-east-1a"
    hints:
      forZones:
        - name: "us-east-1a"
  - addresses:
      - "10.0.2.2"
    conditions:
      ready: true
    hostname: pod-2
    nodeName: worker-2
    zone: "us-east-1b"
    hints:
      forZones:
        - name: "us-east-1b"
```

## Advanced Routing Patterns

### Multi-Zone Load Balancing

Implement sophisticated load balancing across zones while respecting topology:

```yaml
apiVersion: v1
kind: Service
metadata:
  name: multi-zone-service
  annotations:
    service.kubernetes.io/topology-aware-hints: "auto"
    service.kubernetes.io/topology-mode: "Auto"
spec:
  selector:
    app: multi-zone-app
  ports:
  - port: 80
    targetPort: 8080
  sessionAffinity: ClientIP
  sessionAffinityConfig:
    clientIP:
      timeoutSeconds: 10800
```

### Cross-Zone Failover

Configure cross-zone failover for high availability:

```yaml
apiVersion: v1
kind: Service
metadata:
  name: failover-service
  annotations:
    service.kubernetes.io/topology-aware-hints: "auto"
    service.kubernetes.io/topology-mode: "Auto"
    service.kubernetes.io/local-zone-recovery: "true"
spec:
  selector:
    app: resilient-app
  ports:
  - port: 80
    targetPort: 8080
```

### Weighted Traffic Distribution

Implement weighted traffic distribution across zones:

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: weighted-ingress
  annotations:
    nginx.ingress.kubernetes.io/service-weight: |
      service-zone-a=70,service-zone-b=30
spec:
  rules:
  - http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: service-zone-a
            port:
              number: 80
```

## Multi-Region Architecture

### Global Load Balancing

::div{class="mb-4"}
  Implement global load balancing across multiple regions:
::

::div{class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg overflow-x-auto my-4 border border-gray-200 dark:border-gray-700"}
```
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│                   Global Load Balancer (DNS/GSLB)                       │
│                                                                         │
└───────────────┬─────────────────────────────────┬─────────────────────┬─┘
                │                                 │                     │
                ▼                                 ▼                     ▼
┌───────────────────────────┐   ┌───────────────────────────┐   ┌───────────────────────┐
│                           │   │                           │   │                       │
│   Region: us-east-1       │   │   Region: eu-west-1       │   │   Region: ap-south-1  │
│                           │   │                           │   │                       │
│  ┌─────────┐ ┌─────────┐  │   │  ┌─────────┐ ┌─────────┐  │   │  ┌─────────┐          │
│  │ Zone A  │ │ Zone B  │  │   │  │ Zone A  │ │ Zone B  │  │   │  │ Zone A  │          │
│  └────┬────┘ └────┬────┘  │   │  └────┬────┘ └────┬────┘  │   │  └────┬────┘          │
│       │           │       │   │       │           │       │   │       │               │
│  ┌────▼───────────▼────┐  │   │  ┌────▼───────────▼────┐  │   │  ┌────▼────┐          │
│  │                     │  │   │  │                     │  │   │  │         │          │
│  │  Regional Ingress   │  │   │  │  Regional Ingress   │  │   │  │ Regional │          │
│  │                     │  │   │  │                     │  │   │  │ Ingress  │          │
│  └─────────────────────┘  │   │  └─────────────────────┘  │   │  └─────────┘          │
│                           │   │                           │   │                       │
└───────────────────────────┘   └───────────────────────────┘   └───────────────────────┘
```
::

### Multi-Cluster Federation

Implement federation for multi-cluster topology routing:

```yaml
apiVersion: types.kubefed.io/v1beta1
kind: FederatedService
metadata:
  name: global-service
  namespace: default
spec:
  template:
    spec:
      selector:
        app: global-app
      ports:
      - port: 80
        targetPort: 8080
  placement:
    clusters:
    - name: cluster-us-east
    - name: cluster-eu-west
    - name: cluster-ap-south
  overrides:
  - clusterName: cluster-us-east
    clusterOverrides:
    - path: "metadata.annotations"
      value:
        service.kubernetes.io/topology-aware-hints: "auto"
  - clusterName: cluster-eu-west
    clusterOverrides:
    - path: "metadata.annotations"
      value:
        service.kubernetes.io/topology-aware-hints: "auto"
```

### Regional Affinity with Global Failover

Implement regional traffic affinity with global failover capabilities:

```yaml
apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: global-destination-rule
spec:
  host: global-service
  trafficPolicy:
    loadBalancer:
      localityLbSetting:
        enabled: true
        failover:
          - from: us-east-1
            to: [us-west-1, eu-west-1]
          - from: eu-west-1
            to: [eu-central-1, us-east-1]
        failoverPriority:
          - "topology.kubernetes.io/region"
          - "topology.kubernetes.io/zone"
    outlierDetection:
      consecutive5xxErrors: 3
      interval: 30s
      baseEjectionTime: 30s
```

## Performance Optimization

### Latency-Based Routing

Implement advanced latency-based routing with service mesh tools:

```yaml
apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: latency-optimized-service
spec:
  host: my-service
  trafficPolicy:
    loadBalancer:
      localityLbSetting:
        enabled: true
        distribute:
          - from: us-east/us-east-1/*
            to:
              "us-east/us-east-1/*": 80
              "us-east/us-east-2/*": 20
        failover:
          - from: us-east
            to: [us-west, eu-west]
```

### Bandwidth Cost Optimization

Configure routing to minimize cross-zone data transfer costs:

```yaml
apiVersion: v1
kind: Service
metadata:
  name: cost-optimized-service
  annotations:
    service.kubernetes.io/topology-aware-hints: "auto"
    service.kubernetes.io/topology-mode: "Auto"
    service.kubernetes.io/prefer-local-traffic: "true"
spec:
  selector:
    app: data-intensive-app
  ports:
  - port: 80
    targetPort: 8080
```

## Monitoring and Troubleshooting

### Topology Routing Metrics

Monitor the effectiveness of topology-aware routing with these metrics:

```bash
# Using Prometheus queries for topology metrics
kubectl -n monitoring exec -it prometheus-k8s-0 -- curl -s 'localhost:9090/api/v1/query?query=service_traffic_split{service="topology-aware-service"}' | jq
```

Key metrics to track:

1. **Cross-zone traffic percentage**: Measures traffic routed outside local zones
2. **Zone latency**: Measures response time differences between zones
3. **Endpoint distribution**: Tracks how traffic is distributed across endpoints
4. **Zone failover events**: Records when traffic shifts between zones

### Troubleshooting Common Issues

#### Routing Not Respecting Topology

If traffic isn't following topology hints:

1. Verify feature gate is enabled:
```bash
kubectl get configmap -n kube-system kube-proxy -o yaml | grep "TopologyAwareHints"
```

2. Check EndpointSlice configuration:
```bash
kubectl get endpointslices -o custom-columns=NAME:.metadata.name,HINTS:.endpoints[*].hints
```

3. Validate node labels:
```bash
kubectl get nodes --show-labels | grep topology
```

#### Imbalanced Zone Distribution

If traffic is heavily skewed to certain zones:

1. Check pod distribution:
```bash
kubectl get pods -o wide | grep app=myapp
```

2. Adjust deployment to ensure even zone distribution:
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: zone-balanced-app
spec:
  replicas: 6
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
    spec:
      topologySpreadConstraints:
      - maxSkew: 1
        topologyKey: topology.kubernetes.io/zone
        whenUnsatisfiable: DoNotSchedule
        labelSelector:
          matchLabels:
            app: myapp
```

## Practical Implementation Examples

### E-Commerce Platform with Global Presence

Implement topology-aware routing for a global e-commerce application:

```yaml
# Deployment ensuring zone distribution
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ecommerce-api
spec:
  replicas: 9
  selector:
    matchLabels:
      app: ecommerce-api
  template:
    metadata:
      labels:
        app: ecommerce-api
    spec:
      topologySpreadConstraints:
      - maxSkew: 1
        topologyKey: topology.kubernetes.io/zone
        whenUnsatisfiable: ScheduleAnyway
        labelSelector:
          matchLabels:
            app: ecommerce-api
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 100
            podAffinityTerm:
              labelSelector:
                matchExpressions:
                - key: app
                  operator: In
                  values:
                  - ecommerce-api
              topologyKey: topology.kubernetes.io/zone
      containers:
      - name: api-server
        image: ecommerce/api-server:v1.0
        resources:
          limits:
            cpu: 500m
            memory: 512Mi
          requests:
            cpu: 200m
            memory: 256Mi
```

```yaml
# Service with topology-aware routing
apiVersion: v1
kind: Service
metadata:
  name: ecommerce-api
  annotations:
    service.kubernetes.io/topology-aware-hints: "auto"
spec:
  selector:
    app: ecommerce-api
  ports:
  - port: 80
    targetPort: 8080
  sessionAffinity: ClientIP
```

### Financial Services with Multi-Region Redundancy

Configure a financial services application with strict topology requirements:

```yaml
# Regional Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: financial-app-us-east
  namespace: financial-services
spec:
  replicas: 6
  selector:
    matchLabels:
      app: financial-app
      region: us-east
  template:
    metadata:
      labels:
        app: financial-app
        region: us-east
    spec:
      nodeSelector:
        topology.kubernetes.io/region: us-east-1
      topologySpreadConstraints:
      - maxSkew: 1
        topologyKey: topology.kubernetes.io/zone
        whenUnsatisfiable: DoNotSchedule
        labelSelector:
          matchLabels:
            app: financial-app
            region: us-east
      containers:
      - name: financial-service
        image: financial/service:v2.3
        env:
        - name: REGION
          value: "us-east-1"
```

```yaml
# Global Service with regional failover
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: financial-global-service
  namespace: financial-services
spec:
  hosts:
  - "api.financial-app.com"
  gateways:
  - financial-gateway
  http:
  - route:
    - destination:
        host: financial-app-us-east
        port:
          number: 80
      weight: 100
    - destination:
        host: financial-app-eu-west
        port:
          number: 80
      weight: 0
    retries:
      attempts: 3
      perTryTimeout: 500ms
    fault:
      abort:
        percentage:
          value: 0
        httpStatus: 503
```

## Best Practices and Recommendations

::div{class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"}
  ::div{class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-6 shadow-sm"}
    ::div{class="flex items-center mb-4"}
      ::div{class="text-blue-600 dark:text-blue-400"}
        <Icon name="lucide:layout" class="h-6 w-6" />
      ::
      ::h3{class="ml-2 text-xl font-semibold"}
        Topology Design Principles
      ::
    ::
    ::div{class="space-y-3"}
      ::div{class="flex"}
        ::div{class="flex-shrink-0 h-6 w-6 flex items-center justify-center rounded-full bg-blue-100 dark:bg-blue-800 text-blue-600 dark:text-blue-300 font-bold text-sm mr-3"}
          1
        ::
        ::div{class="text-gray-700 dark:text-gray-300"}
          **Consistent labeling**: Ensure all nodes have accurate topology labels
        ::
      ::
      ::div{class="flex"}
        ::div{class="flex-shrink-0 h-6 w-6 flex items-center justify-center rounded-full bg-blue-100 dark:bg-blue-800 text-blue-600 dark:text-blue-300 font-bold text-sm mr-3"}
          2
        ::
        ::div{class="text-gray-700 dark:text-gray-300"}
          **Balanced deployments**: Use topology spread constraints for even distribution
        ::
      ::
      ::div{class="flex"}
        ::div{class="flex-shrink-0 h-6 w-6 flex items-center justify-center rounded-full bg-blue-100 dark:bg-blue-800 text-blue-600 dark:text-blue-300 font-bold text-sm mr-3"}
          3
        ::
        ::div{class="text-gray-700 dark:text-gray-300"}
          **Graceful degradation**: Configure sensible failover paths
        ::
      ::
      ::div{class="flex"}
        ::div{class="flex-shrink-0 h-6 w-6 flex items-center justify-center rounded-full bg-blue-100 dark:bg-blue-800 text-blue-600 dark:text-blue-300 font-bold text-sm mr-3"}
          4
        ::
        ::div{class="text-gray-700 dark:text-gray-300"}
          **Cost consciousness**: Prioritize local routing to minimize cross-zone charges
        ::
      ::
      ::div{class="flex"}
        ::div{class="flex-shrink-0 h-6 w-6 flex items-center justify-center rounded-full bg-blue-100 dark:bg-blue-800 text-blue-600 dark:text-blue-300 font-bold text-sm mr-3"}
          5
        ::
        ::div{class="text-gray-700 dark:text-gray-300"}
          **Performance monitoring**: Track and optimize topology-related metrics
        ::
      ::
    ::
  ::
  
  ::div{class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700"}
    ::div{class="flex items-center mb-4"}
      ::div{class="text-blue-600 dark:text-blue-400"}
        <Icon name="lucide:check-square" class="h-6 w-6" />
      ::
      ::h3{class="ml-2 text-xl font-semibold"}
        Implementation Checklist
      ::
    ::
    ::div{class="space-y-3"}
      ::div{class="flex items-start"}
        ::div{class="flex-shrink-0 mt-0.5"}
          <Icon name="lucide:square" class="h-5 w-5 text-blue-500 dark:text-blue-400" />
        ::
        ::div{class="ml-2 text-gray-700 dark:text-gray-300"}
          Properly labeled all nodes with topology information
        ::
      ::
      ::div{class="flex items-start"}
        ::div{class="flex-shrink-0 mt-0.5"}
          <Icon name="lucide:square" class="h-5 w-5 text-blue-500 dark:text-blue-400" />
        ::
        ::div{class="ml-2 text-gray-700 dark:text-gray-300"}
          Enabled required feature gates in all cluster components
        ::
      ::
      ::div{class="flex items-start"}
        ::div{class="flex-shrink-0 mt-0.5"}
          <Icon name="lucide:square" class="h-5 w-5 text-blue-500 dark:text-blue-400" />
        ::
        ::div{class="ml-2 text-gray-700 dark:text-gray-300"}
          Configured services with appropriate topology annotations
        ::
      ::
      ::div{class="flex items-start"}
        ::div{class="flex-shrink-0 mt-0.5"}
          <Icon name="lucide:square" class="h-5 w-5 text-blue-500 dark:text-blue-400" />
        ::
        ::div{class="ml-2 text-gray-700 dark:text-gray-300"}
          Set up monitoring for cross-zone traffic and latency
        ::
      ::
      ::div{class="flex items-start"}
        ::div{class="flex-shrink-0 mt-0.5"}
          <Icon name="lucide:square" class="h-5 w-5 text-blue-500 dark:text-blue-400" />
        ::
        ::div{class="ml-2 text-gray-700 dark:text-gray-300"}
          Implemented topology spread constraints for deployments
        ::
      ::
      ::div{class="flex items-start"}
        ::div{class="flex-shrink-0 mt-0.5"}
          <Icon name="lucide:square" class="h-5 w-5 text-blue-500 dark:text-blue-400" />
        ::
        ::div{class="ml-2 text-gray-700 dark:text-gray-300"}
          Tested failover scenarios between zones and regions
        ::
      ::
      ::div{class="flex items-start"}
        ::div{class="flex-shrink-0 mt-0.5"}
          <Icon name="lucide:square" class="h-5 w-5 text-blue-500 dark:text-blue-400" />
        ::
        ::div{class="ml-2 text-gray-700 dark:text-gray-300"}
          Documented topology architecture and failover paths
        ::
      ::
    ::
  ::
::

## Conclusion

::div{class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-6 mb-6"}
  ::div{class="prose dark:prose-invert max-w-none"}
    Kubernetes Topology Aware Routing provides powerful capabilities for optimizing application performance, reducing costs, and enhancing resilience in distributed environments. By intelligently routing traffic based on infrastructure topology, organizations can deliver lower-latency experiences to users while minimizing cross-zone data transfer expenses.
  ::
::

::div{class="mt-6"}
  ::h3{class="text-xl font-semibold mb-4 flex items-center"}
    <Icon name="lucide:check-circle" class="h-6 w-6 text-blue-500 mr-2" /> Key Benefits
  ::

  ::div{class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"}
    ::div{class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm"}
      ::div{class="flex items-center mb-2"}
        ::div{class="bg-blue-100 dark:bg-blue-800 p-2 rounded-md"}
          <Icon name="lucide:zap" class="h-5 w-5 text-blue-600 dark:text-blue-400" />
        ::
        ::div{class="ml-2 font-semibold"}
          Improved Performance
        ::
      ::
      ::div{class="text-sm text-gray-600 dark:text-gray-400"}
        Lower latency through local endpoint preference
      ::
    ::
    
    ::div{class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm"}
      ::div{class="flex items-center mb-2"}
        ::div{class="bg-blue-100 dark:bg-blue-800 p-2 rounded-md"}
          <Icon name="lucide:coins" class="h-5 w-5 text-blue-600 dark:text-blue-400" />
        ::
        ::div{class="ml-2 font-semibold"}
          Cost Optimization
        ::
      ::
      ::div{class="text-sm text-gray-600 dark:text-gray-400"}
        Reduced cross-zone data transfer charges
      ::
    ::
    
    ::div{class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm"}
      ::div{class="flex items-center mb-2"}
        ::div{class="bg-blue-100 dark:bg-blue-800 p-2 rounded-md"}
          <Icon name="lucide:shield" class="h-5 w-5 text-blue-600 dark:text-blue-400" />
        ::
        ::div{class="ml-2 font-semibold"}
          Enhanced Resilience
        ::
      ::
      ::div{class="text-sm text-gray-600 dark:text-gray-400"}
        Better fault isolation during partial outages
      ::
    ::
    
    ::div{class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm"}
      ::div{class="flex items-center mb-2"}
        ::div{class="bg-blue-100 dark:bg-blue-800 p-2 rounded-md"}
          <Icon name="lucide:globe" class="h-5 w-5 text-blue-600 dark:text-blue-400" />
        ::
        ::div{class="ml-2 font-semibold"}
          Global Scalability
        ::
      ::
      ::div{class="text-sm text-gray-600 dark:text-gray-400"}
        Simplified management of multi-region deployments
      ::
    ::
    
    ::div{class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm"}
      ::div{class="flex items-center mb-2"}
        ::div{class="bg-blue-100 dark:bg-blue-800 p-2 rounded-