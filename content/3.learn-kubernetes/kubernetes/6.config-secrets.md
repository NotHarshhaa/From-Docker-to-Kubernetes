---
title: ConfigMaps & Secrets
description: Understanding Kubernetes configuration and secrets management
icon: 'lucide:settings'
---

## Configuration Management

Kubernetes provides ConfigMaps and Secrets to decouple configuration from pod specifications.

## ConfigMaps

::steps
### Basic ConfigMap
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
data:
  app.properties: |
    color.background=blue
    color.foreground=white
  app.yml: |
    server:
      port: 8080
  database_url: mongodb://localhost:27017
```

### Using ConfigMaps
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: config-pod
spec:
  containers:
  - name: app
    image: myapp:1.0
    envFrom:
    - configMapRef:
        name: app-config
    volumeMounts:
    - name: config-volume
      mountPath: /etc/config
  volumes:
  - name: config-volume
    configMap:
      name: app-config
```
::

## Secrets

::steps
### Creating Secrets
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
type: Opaque
data:
  username: YWRtaW4=      # base64 encoded
  password: cGFzc3dvcmQ=  # base64 encoded
```

### Using Secrets
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secret-pod
spec:
  containers:
  - name: app
    image: myapp:1.0
    env:
    - name: DB_USER
      valueFrom:
        secretKeyRef:
          name: app-secrets
          key: username
    volumeMounts:
    - name: secret-volume
      mountPath: /etc/secrets
      readOnly: true
  volumes:
  - name: secret-volume
    secret:
      secretName: app-secrets
```
::

## Configuration Best Practices

::alert{type="info"}
1. Keep configurations separate from code
2. Use meaningful names
3. Version control configs
4. Implement proper RBAC
5. Encrypt sensitive data
6. Regular rotation of secrets
::

## Environment Variables

### From ConfigMap
```yaml
spec:
  containers:
  - name: app
    image: myapp:1.0
    env:
    - name: APP_COLOR
      valueFrom:
        configMapKeyRef:
          name: app-config
          key: color.background
```

### From Multiple Sources
```yaml
spec:
  containers:
  - name: app
    image: myapp:1.0
    envFrom:
    - configMapRef:
        name: app-config
    - secretRef:
        name: app-secrets
```

## Volume Mounts

::steps
### ConfigMap as Volume
```yaml
spec:
  containers:
  - name: app
    volumeMounts:
    - name: config
      mountPath: /etc/config
  volumes:
  - name: config
    configMap:
      name: app-config
```

### Secret as Volume
```yaml
spec:
  containers:
  - name: app
    volumeMounts:
    - name: secrets
      mountPath: /etc/secrets
  volumes:
  - name: secrets
    secret:
      secretName: app-secrets
```
::

## Dynamic Updates

::alert{type="warning"}
- ConfigMaps update automatically
- Volume-mounted ConfigMaps sync periodically
- Environment variables don't update
- Pods may need restart for changes
::

## Secret Types

::steps
### Built-in Types
- Opaque (default)
- kubernetes.io/service-account-token
- kubernetes.io/dockercfg
- kubernetes.io/dockerconfigjson
- kubernetes.io/basic-auth
- kubernetes.io/ssh-auth
- kubernetes.io/tls

### Custom Secret Type
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: mysecret
type: mycompany.com/secret-type
data:
  custom-key: dmFsdWU=
```
::

## Configuration Management Tools

::steps
### Helm
- Package manager
- Template engine
- Release management
- Configuration reuse

### Kustomize
- Configuration customization
- No templates
- Overlay-based
- Native Kubernetes
::

## Security Considerations

::alert{type="warning"}
1. Limit access to ConfigMaps/Secrets
2. Use encryption at rest
3. Rotate secrets regularly
4. Monitor access patterns
5. Implement least privilege
6. Use proper namespaces
::

## Troubleshooting

Common issues and solutions:
1. ConfigMap not updating
2. Secret mounting issues
3. Permission problems
4. Encoding/decoding errors
5. Volume mount failures

## Advanced Usage

### Immutable ConfigMaps
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: immutable-config
  namespace: default
immutable: true
data:
  app.properties: |
    key=value
```

### Secret Data Keys
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: tls-secret
type: kubernetes.io/tls
data:
  tls.crt: base64-encoded-cert
  tls.key: base64-encoded-key
```

## Best Practices Checklist

::alert{type="info"}
1. Use descriptive names
2. Implement proper RBAC
3. Version control non-sensitive configs
4. Separate sensitive data
5. Regular secret rotation
6. Monitor usage patterns
7. Document configurations
8. Use namespaces
9. Implement immutability when needed
10. Regular audits
::